#' Plot the missing data patterns for the optimal PM design.
#' 
#' @param object The simPM object
#' @param colbr colors for waves. Default is "PRGn".
#' @param col colors for complete vs. missing data. Default is c("antiquewhite1","firebrick").
#' @param labels logical, indicating whether the label for waves is needed. Default is T.
#' @param fontsize_col specify the font size for the column labels. Default is 20.
#' @param fontsize_row specify the font size for the row labels. Default is 14.
#' @param fontsize specify the font size for the legend. Default is 14.
#' @param angle_col specify the angle of how the column labels are displayed
#' @param legend logical, indicating whether the legend is shown. Default is T.
#' @param main specify the plot title

# @seealso \code{\link[pheatmap]{pheatmap}} 
#' @import pheatmap
#' @import RColorBrewer
#' @export plotPM
#' 
#' @examples
#' \dontrun{
#' plotPM(wave.out)
#' plotPM(indicator.out)
#' plotPM(forward.out,labels=F,col=c("gray96","gray35"),fontsize_row=26,fontsize=18,fontsize_col=26)
#' }

plotPM=function(object,
                Time,
                k,
                colbr="PRGn",
                col=c("antiquewhite1","firebrick"),
                row.names=T,
                labels=T,
                fontsize_col=20,
                fontsize_row=14,
                fontsize=14,
                angle_col=45,
                legend=T,
                main=""){
  data=object$opt.pattern
  if (row.names==T){
    row.names(data)=paste0(paste0("pat",1:nrow(data),":",sep=""),"n=",object$opt.ns)
  }
  annotation=data.frame(Wave=factor(rep(c(1:Time),each=k), labels = paste0("W",1:Time)))
  rownames(annotation) <- colnames(data)
  mat_colors <- list(Wave = brewer.pal(Time, colbr))
  names(mat_colors$Wave) <- paste0("W",1:Time)
  
  gaps=seq(k,(Time-1)*k,by=k)
  
  if (labels==T){
    pheatmap(data, scale = "none",col=col,
             cluster_rows = F, cluster_cols = F,legend=legend,legend_breaks=c(0,1),legend_labels=c("complete","missing"),fontsize_row = fontsize_row, fontsize_col=fontsize_col,fontsize=fontsize,drop_levels=T,annotation = annotation,annotation_colors = mat_colors,angle_col=angle_col,gaps_col=gaps,main=main)
  }
  
  if (labels==F){
    pheatmap(data, scale = "none",col=col,
             cluster_rows = F, cluster_cols = F,legend=legend,legend_breaks=c(0,1),fontsize_row = fontsize_row,legend_labels=c("complete","missing"), fontsize_col=fontsize_col,fontsize=fontsize,drop_levels=T,angle_col=angle_col,gaps_col=gaps,main=main)
  }
}
