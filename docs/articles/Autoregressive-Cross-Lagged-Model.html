<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An example of PHPM with an autoregressive and cross-lagged model â€¢ simPM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An example of PHPM with an autoregressive and cross-lagged model">
<meta property="og:description" content="simPM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simPM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/Autoregressive-Cross-Lagged-Model.html">An Example of PHPM with an Autoregression and Cross-lagged Model</a>
    </li>
    <li>
      <a href="../articles/Conditional-Linear-Latent-Growth-Model.html">An Example of PHPM with a Conditional Linear Latent Growth Model</a>
    </li>
    <li>
      <a href="../articles/Wave-Level-PHPM.html">Wave-level PM designs</a>
    </li>
    <li>
      <a href="../articles/Item-Level-PHPM.html">Item-level PM designs</a>
    </li>
    <li>
      <a href="../articles/Forward-Assembly-PHPM.html">Forward assembly</a>
    </li>
    <li>
      <a href="../articles/Summary.html">Summarize the optimal design</a>
    </li>
    <li>
      <a href="../articles/PlotPM.html">Plot the optimal design</a>
    </li>
  </ul>
</li>
<li>
  <a href="../manual/simPM_0.0.0.9000.pdf">
    <span class="fa fa-pencil-square-o"></span>
     
    Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    FAQ
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YiFengEDMS/simPM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/TheYiFeng">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An example of PHPM with an autoregressive and cross-lagged model</h1>
                        <h4 class="author">Yi Feng &amp; Gregory R. Hancock</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/YiFengEDMS/simPM/blob/master/vignettes/Autoregressive-Cross-Lagged-Model.Rmd"><code>vignettes/Autoregressive-Cross-Lagged-Model.Rmd</code></a></small>
      <div class="hidden name"><code>Autoregressive-Cross-Lagged-Model.Rmd</code></div>

    </div>

    
    
<!-- -->
<p>In this vignette we will demonstrate how to use <code>simPM</code> to search for an optimal PHPM design for a longitudinal research study that employs an utoregressive and cross-lagged model.</p>
<div id="research-scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#research-scenario" class="anchor"></a><span style="color:seagreen"><strong>Research Scenario</strong></span>
</h2>
<p>Suppose a group of researchers is interested in examining the longitudinal reciprocal relations between peer relationships and teacher-child relationships. They have been funded for a longitudinal panel study following 1000 children for three years. Each year they would collect data on three measures: two measures of peer relationships (self-perceived popularity and peer-perceived popularity) and one measure of teacher-child relationships (teacher-child support). Upon the completion of data collection, they plan to fit an autoregressive cross-lagged model shown below. The parameter of focal interest to the researchers are the cross-lagged path coefficients predicting the peer-perceived popularity from the self-perceived popularity measured at the previous time point, as well as in the cross-lagged paths predicting teacher-child support from the peer-perceived popularity measured at the previous time point (marked in red).</p>
<p>Unfortunately, after the first wave of data collection, the funding agency announces a 30% reduction in the remaining funding. The researcher wishes to continue the project under the budget constraint, with the hope to not compromise the scientific rigor and statistical power. The reseacher thus decideds to use <code>simPM</code> to find a design that yields sufficient power but costs no more than the reduced budget.</p>
<div class="figure" style="text-align: center">
<img src="images/Autoregressive-cross-lagged.png" alt="An autoregressive and cross-lagged model" width="70%"><p class="caption">
An autoregressive and cross-lagged model
</p>
</div>
</div>
<div id="spcify-the-population-and-analysis-model" class="section level2">
<h2 class="hasAnchor">
<a href="#spcify-the-population-and-analysis-model" class="anchor"></a><span style="color:seagreen"><strong>Spcify the Population and Analysis Model</strong></span>
</h2>
<p>Because <code>simPM</code> searches for an optimal design based on power analysis using Monte Carlo simulations, it is thus required to supply a population model and analysis model. The easiest way to specify the population model and analysis model is to use the <a href="http://lavaan.ugent.be/tutorial/syntax1.html"><code>lavaan</code> model syntax</a>. For this example, the population model is specified as follows:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">popModel</span> <span class="kw">&lt;-</span> <span class="st">[1050 chars quoted with ''']</span></pre></body></html></div>
<p>The analysis model is specified as the same autoregressive and cross-lagged model but with freely estimated model parameters:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">analyzeModel</span> <span class="kw">&lt;-</span> <span class="st">'

#----------- path coefficients ------------#

SelfPop2~SelfPop1+PeerPop1
SelfPop3~SelfPop2+PeerPop2

PeerPop2~SelfPop1+PeerPop1+Support1
PeerPop3~SelfPop2+PeerPop2+Support2

Support2~Support1+PeerPop1
Support3~Support2+PeerPop2

#----------- residual covariance ----------#

PeerPop1~~SelfPop1+Support1
SelfPop1~~Support1

PeerPop2~~SelfPop2+Support2
SelfPop2~~Support2

PeerPop3~~SelfPop3+Support3
SelfPop3~~Support3


#---------------- means -------------------#

PeerPop1~1
SelfPop1~1
Support1~1

PeerPop2~1
SelfPop2~1
Support2~1

PeerPop3~1
SelfPop3~1
Support3~1


#--------------- variances ----------------#

PeerPop1~~PeerPop1
SelfPop1~~SelfPop1
Support1~~Support1

PeerPop2~~PeerPop2
SelfPop2~~SelfPop2
Support2~~Support2

PeerPop3~~PeerPop3
SelfPop3~~SelfPop3
Support3~~Support3

'</span></pre></body></html></div>
</div>
<div id="wave-level-phpm-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#wave-level-phpm-designs" class="anchor"></a><span style="color:seagreen"><strong>Wave-level PHPM Designs</strong></span>
</h2>
<div id="search-for-an-optimal-wave-level-design" class="section level3">
<h3 class="hasAnchor">
<a href="#search-for-an-optimal-wave-level-design" class="anchor"></a><a name="wave">1. Search for an Optimal Wave-level Design</a>
</h3>
<p>We can use the main function <code><a href="../reference/simPM.html">simPM()</a></code> to search for an optimal <a href="Wave-Level-PHPM.html">wave-level missing design</a>. For <code><a href="../reference/simPM.html">simPM()</a></code> to work properly, we need to supply the relevant information about this longitudinal study. By running the following code, <code>simPM</code> will automatically map out all the possible wave-level PHPM designs, run power analysis for each plausible design, and output the optimal design.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">wave.ex3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/simPM.html">simPM</a></span>(<span class="kw">popModel</span> <span class="kw">=</span> <span class="no">popModel</span>,                               <span class="co">#supply the population model using lavaan syntax</span>
                  <span class="kw">analyzeModel</span> <span class="kw">=</span> <span class="no">analyzeModel</span>,                       <span class="co">#supply the analysis model using lavaan syntax</span>
                  <span class="kw">VarNAMES</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop1"</span>,<span class="st">"SelfPop1"</span>,<span class="st">"Support1"</span>,
                               <span class="st">"PeerPop2"</span>,<span class="st">"SelfPop2"</span>,<span class="st">"Support2"</span>,
                               <span class="st">"PeerPop3"</span>,<span class="st">"SelfPop3"</span>,<span class="st">"Support3"</span>),    <span class="co">#the observed variable names, grouped in waves, in chronological order</span>
                  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,                                 <span class="co">#specify any distal variables that are not subject to planned missingness</span>
                  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">1000</span>,                                          <span class="co">#original sample size</span>
                  <span class="kw">nreps</span> <span class="kw">=</span> <span class="fl">1000</span>,                                      <span class="co">#number of replications for Monte Carlo simulation</span>
                  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234</span>,                                       <span class="co">#random seed</span>
                  <span class="kw">Time</span> <span class="kw">=</span> <span class="fl">3</span>,                                          <span class="co">#total number of waves</span>
                  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>,                                             <span class="co">#number of observed variables collected at each wave</span>
                  <span class="kw">Time.complete</span> <span class="kw">=</span> <span class="fl">1</span>,                                 <span class="co">#number of waves completed before funding cut occurs</span>
                  <span class="kw">costmx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>),                   <span class="co">#unit cost of each data point at the following waves</span>
                  <span class="kw">pc</span> <span class="kw">=</span> <span class="fl">0.1</span>,                                          <span class="co">#percentage of participants to provide complete data after funding cut</span>
                  <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">0</span>,                                            <span class="co">#percentage of participants to provide no data after funding cut</span>
                  <span class="kw">focal.param</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop2~SelfPop1"</span>,
                                <span class="st">"Support2~PeerPop1"</span>,
                                <span class="st">"PeerPop3~SelfPop2"</span>,
                                <span class="st">"Support3~PeerPop2"</span>),                <span class="co">#specify the focal parameters, using lavaan syntax</span>
                  <span class="kw">eval.budget</span> <span class="kw">=</span> <span class="no">T</span>,                                   <span class="co">#whether or not there is a budget restriction</span>
                  <span class="kw">rm.budget</span> <span class="kw">=</span> <span class="fl">45</span>*<span class="fl">1000</span>*<span class="fl">0.7</span>,                           <span class="co">#the amount of remaining available budget</span>
                  <span class="kw">complete.wave</span> <span class="kw">=</span> <span class="kw">NULL</span>,                              <span class="co">#specify any future wave that need complete data to be collected</span>
                  <span class="kw">engine</span> <span class="kw">=</span> <span class="st">"l"</span>,                                      <span class="co">#use lavaan and simsem to fit the models</span>
                  <span class="kw">methods</span> <span class="kw">=</span> <span class="st">"wave"</span>                                    <span class="co">#type of PHPM designs under consideration, "wave" indicates wave-level missing</span>
                  )</pre></body></html></div>
<p>More specifically:</p>
<ul>
<li>
<code>VarNAMES = c("PeerPop1","SelfPop1","Support1", "PeerPop2","SelfPop2","Support2","PeerPop3","SelfPop3","Support3")</code>: The observed variables collected in this study are named <span style="color:firebrick">PeerPop1, SelfPop1, Support1, PeerPop2, SelfPop2, Support2, PeerPop3, SelfPop3, Support3</span>.</li>
<li>
<code>Time = 3</code>: The study has <span style="color:firebrick">3</span> waves of data collection in total.</li>
<li>
<code>Time.complete = 1</code>: <span style="color:firebrick">One</span> wave of data collection has been completed before funding cut occurs.</li>
<li>
<code>k = 3</code>: <span style="color:firebrick">Three</span> observed variable are collected at each wave of data collection.</li>
<li>
<code>pc = 0.1</code>: <span style="color:firebrick">Ten percent</span> of the participants are randomly assigned to provide complete data for future waves after funding cut.</li>
<li>
<code>pd = 0</code>: <span style="color:firebrick">Zero percent</span> of the participants are assigned to drop from the study.</li>
<li>
<code>costmx = c(5, 5, 5, 10, 10, 10)</code>: The unit cost of collecting one report from the father, the mother, or the teacher is <span style="color:firebrick">$5</span> at wave 2 and <span style="color:firebrick">$10</span> at wave 3.<br>
</li>
<li>
<code>n = 1000</code>: The original sample size planned was <span style="color:firebrick">1,000</span>.</li>
<li>
<code>nreps = 1000</code>: The program will run <span style="color:firebrick">1000</span> replications for Monte Carlo simulation (for each plausible design).</li>
<li>
<code>focal.param=c("PeerPop2~SelfPop1","Support2~PeerPop1","PeerPop3~SelfPop2","Support3~PeerPop2")</code>: The focal parameters of interest are the cross-lagged path coefficients predicting peer-perceived popularity from self-perceived popularity and the cross-lagged path coefficients predicting teacher-child support from peer-perceived popularity.</li>
<li>
<code>complete.wave = NULL</code>: No future waves are by design to have complete data colleted from all of the three sources.</li>
<li>
<code>eval.budget = T</code>: Yes, there is a budget restriction that needs to be taken into consideration.</li>
<li>
<code>rm.budget = 45*1000*0.7</code>: After the funding cut, the researcher will have <span style="color:firebrick"> <span class="math inline">\(\$31,500\)</span> </span> <span class="math inline">\((=45\times1000\times0.7)\)</span> to support the future waves of data collection.</li>
<li>
<code>distal.var = NULL</code>: There are no distal variables in the model that are not subject to repeated measures.</li>
<li>
<code>engine = "l"</code>: Data were simulated using <code>simsem</code> and the models were fitted using <code>lavaan</code>.</li>
<li>
<code>methods = "wave"</code>: Search for wave-level missing designs.</li>
</ul>
</div>
<div id="summarize-the-result" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result" class="anchor"></a>2. Summarize the Result</h3>
<p>To <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="../reference/summary.simpm.html">summary.simpm()</a></code> function. It prints out the comparison among all the plausible wave-level missing designs (with regard to the parameter with the lowest empirical power), the optimal design that was selected, the details about the focal parameters for the selected optimal design, the missing data pattern for the selected optimal PHPM design, and the proportion as well as the number of participants assigned to each unqie missing data pattern.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wave.ex3</span>)</pre></body></html></div>
<p>For this example, there is only one possible wave-level PHPM design given the budget constraints. Therefore, the program has run simulations only for this one possible design. This design costs $24,750, which is below the reduced available budget.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">[1] "=================results summary================"
  convergence.rate weakest.param.name weakest.para.power cost.design miss.waves
1                1  PeerPop3~SelfPop2              0.358       24750          1
[1] "=================Optimal design================="
  convergence.rate weakest.param.name weakest.para.power cost.design miss.waves
1                1  PeerPop3~SelfPop2              0.358       24750          1</pre></body></html></div>
<p>With this design, 10% of the participants are assigned to provide complete data across all the future waves of data collection. The rest 90% of the participants are randomly assigned to one of the three unique missing data patterns (<span class="math inline">\(n=450\)</span> in each pattern).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           PeerPop1 SelfPop1 Support1 PeerPop2 SelfPop2 Support2 PeerPop3 SelfPop3 Support3
                  0        0        0        1        1        1        0        0        0
                  0        0        0        0        0        0        1        1        1
completers        0        0        0        0        0        0        0        0        0
[1] "=================Optimal probs=================="
[1] 0.45 0.45 0.10
[1] "=================Optimal ns===================="
[1] 450 450 100</pre></body></html></div>
<p>Over 1000 replications, this design yields poor statistical power for testing most of the focal parameters. The empirical power for testing <span class="math inline">\(b_{PS_1}\)</span> is 0.681 and 0.358 for testing <span class="math inline">\(b_{PS_2}\)</span>. The power is 0.834 for testing <span class="math inline">\(b_{TP_1}\)</span> and 0.642 for testing <span class="math inline">\(b_{TP_2}\)</span>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
                  Estimate Average Estimate SD Average SE Power (Not equal 0)    Std Est Std Est SD Std Ave SE Average Param  Average Bias
PeerPop2~SelfPop1       0.05015451  0.02113615 0.02038431               0.681 0.07585215 0.03185897 0.03076342         0.051 -8.454893e-04
Support2~PeerPop1       0.12303069  0.04152845 0.04179084               0.834 0.10939710 0.03665247 0.03692004         0.124 -9.693051e-04
PeerPop3~SelfPop2       0.05607364  0.03602006 0.03485226               0.358 0.08512223 0.05447372 0.05276132         0.056  7.363818e-05
Support3~PeerPop2       0.13345178  0.05734917 0.05745153               0.642 0.12809893 0.05467605 0.05477553         0.132  1.451783e-03
                  Coverage Average FMI1    SD FMI1
PeerPop2~SelfPop1    0.936    0.3647029 0.02633273
Support2~PeerPop1    0.955    0.4380497 0.02350980
PeerPop3~SelfPop2    0.936    0.8057133 0.01852440
Support3~PeerPop2    0.951    0.7088486 0.02283863</pre></body></html></div>
<!--&nbsp;-->
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out the detailed model fitting results over the replications.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wave.ex3</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>To <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../reference/plotPM.html">plotPM()</a></code> function. It will plot the missing data pattern matrix so people can have a more intuitive understanding of the optimal design that was selected. In this plot, each row represents a unique missing data pattern. Each column represents an observed variable. The number of participants assigned to each missing data pattern is also labeled.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/plotPM.html">plotPM</a></span>(<span class="no">wave.ex3</span>, <span class="kw">fontsize_col</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">angle_col</span> <span class="kw">=</span> <span class="fl">90</span>)</pre></body></html></div>
<p><img src="Autoregressive-Cross-Lagged-Model_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
</div>
</div>
<div id="balanced-item-level-phpm-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#balanced-item-level-phpm-designs" class="anchor"></a><span style="color:seagreen"><strong>Balanced Item-level PHPM Designs</strong></span>
</h2>
<div id="item" class="section level3">
<h3 class="hasAnchor">
<a href="#item" class="anchor"></a>1. Search for an Optimal Item-level Design</h3>
<p>We can also use the function <code><a href="../reference/simPM.html">simPM()</a></code> to search for an optimal <a href="Item-Level-PHPM.html">item-level missing design</a>. The code to search for optimal item-level PHPM designs is very similar to the code to search for optimal wave-level PHPM designs. The minor differences in the code are followed with comments.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">item.ex3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/simPM.html">simPM</a></span>(
  <span class="no">popModel</span>,
  <span class="no">analyzeModel</span>,
  <span class="kw">VarNAMES</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop1"</span>,<span class="st">"SelfPop1"</span>,<span class="st">"Support1"</span>,<span class="st">"PeerPop2"</span>,<span class="st">"SelfPop2"</span>,<span class="st">"Support2"</span>,<span class="st">"PeerPop3"</span>,<span class="st">"SelfPop3"</span>,<span class="st">"Support3"</span>),
  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">n</span><span class="kw">=</span><span class="fl">1000</span>,
  <span class="kw">nreps</span><span class="kw">=</span><span class="fl">10</span>,
  <span class="kw">seed</span><span class="kw">=</span><span class="fl">12345</span>,
  <span class="kw">Time</span><span class="kw">=</span><span class="fl">3</span>,
  <span class="kw">k</span><span class="kw">=</span><span class="fl">3</span>,
  <span class="kw">Time.complete</span><span class="kw">=</span><span class="fl">1</span>,
  <span class="kw">costmx</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>),
  <span class="kw">pc</span><span class="kw">=</span><span class="fl">0.1</span>,
  <span class="kw">pd</span><span class="kw">=</span><span class="fl">0</span>,
  <span class="kw">focal.param</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop2~SelfPop1"</span>,<span class="st">"Support2~PeerPop1"</span>,<span class="st">"PeerPop3~SelfPop2"</span>,<span class="st">"Support3~PeerPop2"</span>),
  <span class="kw">eval.budget</span><span class="kw">=</span><span class="no">T</span>,
  <span class="kw">rm.budget</span><span class="kw">=</span><span class="fl">31500L</span>,        <span class="co"># remaining available budget 45*1000*0.7</span>
  <span class="kw">complete.var</span><span class="kw">=</span><span class="kw">NULL</span>,
  <span class="kw">engine</span><span class="kw">=</span><span class="st">"l"</span>,
  <span class="kw">methods</span><span class="kw">=</span><span class="st">"item"</span>
)</pre></body></html></div>
<p>While most of the arguments are the same as in the case of <a href="#wave">wave-level missing designs</a>, there are two arguments that are a little bit different in the context of item-level missing designs:</p>
<ul>
<li>
<code>complete.var = NULL</code>: No observed variables are by design to have complete data colleted from all participants in the future waves of data collection.</li>
<li>
<code>methods = "item"</code>: Search for item-level missing designs.</li>
</ul>
</div>
<div id="summarize-the-result-1" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result-1" class="anchor"></a>2. Summarize the Result</h3>
<p>Similarly, to <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">item.ex3</span>)</pre></body></html></div>
<p>For this example, given the budget constraints, there are four plausible item-level PHPM designs (with missingness balanced across the patterns). The program thus has run simulations for all the four plausible designs and made comparisons across the designs. The optimal design among the 4 balanced item-level missing designs will cost $31,500, which is equal to the reduced available budget.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">[1] "=================results summary================"
  convergence.rate weakest.param.name weakest.para.power cost.design miss.point
1                1  PeerPop3~SelfPop2              0.721       31500          2
2                1  PeerPop3~SelfPop2              0.523       24750          3
3                1  PeerPop3~SelfPop2              0.361       18000          4
4                1  PeerPop3~SelfPop2              0.257       11250          5
[1] "=================Optimal design================="
  convergence.rate weakest.param.name weakest.para.power cost.design miss.point
1                1  PeerPop3~SelfPop2              0.721       31500          2</pre></body></html></div>
<p>With this design, 10% of the participants are assigned to provide complete data across all the future waves of data collection. The rest 90% of the participants are randomly assigned to one of the 15 unique missing data patterns (<span class="math inline">\(n=60\)</span> in each pattern). In each missing data pattern, the participants are assigned to miss four observed indicators (items) in the future waves of data collection (e.g., self-perceived popularity at wave 2 and peer-perceived popularity at wave 3).</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           PeerPop1 SelfPop1 Support1 PeerPop2 SelfPop2 Support2 PeerPop3 SelfPop3 Support3
                  0        0        0        1        1        0        0        0        0
                  0        0        0        1        0        1        0        0        0
                  0        0        0        1        0        0        1        0        0
                  0        0        0        1        0        0        0        1        0
                  0        0        0        1        0        0        0        0        1
                  0        0        0        0        1        1        0        0        0
                  0        0        0        0        1        0        1        0        0
                  0        0        0        0        1        0        0        1        0
                  0        0        0        0        1        0        0        0        1
                  0        0        0        0        0        1        1        0        0
                  0        0        0        0        0        1        0        1        0
                  0        0        0        0        0        1        0        0        1
                  0        0        0        0        0        0        1        1        0
                  0        0        0        0        0        0        1        0        1
                  0        0        0        0        0        0        0        1        1
completers        0        0        0        0        0        0        0        0        0
[1] "=================Optimal probs=================="
 [1] 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.06 0.10
[1] "=================Optimal ns===================="
 [1]  60  60  60  60  60  60  60  60  60  60  60  60  60  60  60 100</pre></body></html></div>
<p>Over 1000 replications, this design yields an empirical power of 0.786 for testing the path coefficient <span class="math inline">\(b_{PS_1}\)</span>, 0.721 for testing the path coefficient <span class="math inline">\(b_{PS_2}\)</span>, 0.917 for testing the path coefficient <span class="math inline">\(b_{TS_1}\)</span>, and 0.890 for testing the path coefficient <span class="math inline">\(b_{TS_2}\)</span>.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
                  Estimate Average Estimate SD Average SE Power (Not equal 0)    Std Est Std Est SD Std Ave SE Average Param  Average Bias
PeerPop2~SelfPop1       0.05055570  0.01874772 0.01847418               0.786 0.07640485 0.02824061 0.02788479         0.051 -0.0004443034
Support2~PeerPop1       0.12345953  0.03710990 0.03693612               0.917 0.10985168 0.03249985 0.03269727         0.124 -0.0005404742
PeerPop3~SelfPop2       0.05675102  0.02228946 0.02215252               0.721 0.08639815 0.03395195 0.03365353         0.056  0.0007510192
Support3~PeerPop2       0.13073982  0.04158240 0.04079068               0.890 0.12585197 0.03996419 0.03892887         0.132 -0.0012601844
                  Coverage Average FMI1    SD FMI1
PeerPop2~SelfPop1    0.943    0.2266084 0.01766973
Support2~PeerPop1    0.953    0.2816413 0.02098447
PeerPop3~SelfPop2    0.939    0.5163652 0.02112441
Support3~PeerPop2    0.940    0.4224801 0.02196725</pre></body></html></div>
<!--&nbsp;-->
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out the detailed model fitting results over the replications.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">item.ex3</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design-1" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design-1" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>Similarly, to <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../reference/plotPM.html">plotPM()</a></code> function. As shown in the plot, â€¦</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../reference/plotPM.html">plotPM</a></span>(<span class="no">item.ex3</span>, <span class="kw">fontsize_col</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">angle_col</span> <span class="kw">=</span> <span class="fl">90</span>)</pre></body></html></div>
<p><img src="Autoregressive-Cross-Lagged-Model_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
</div>
<div id="item-level-phpm-designs-via-forward-assembly" class="section level2">
<h2 class="hasAnchor">
<a href="#item-level-phpm-designs-via-forward-assembly" class="anchor"></a><span style="color:seagreen"><strong>Item-level PHPM Designs via Forward Assembly</strong></span>
</h2>
<div id="search-for-an-optimal-item-level-design-via-forward-assembly" class="section level3">
<h3 class="hasAnchor">
<a href="#search-for-an-optimal-item-level-design-via-forward-assembly" class="anchor"></a>1. Search for an Optimal Item-level Design via Forward Assembly</h3>
<p>We can also use the function <code><a href="../reference/simPM.html">simPM()</a></code> to search for an optimal <a href="Forward-Assembly-PHPM.html">item-level missing design via forward assembly</a>. We only need to change a few arguments within the <code><a href="../reference/simPM.html">simPM()</a></code> function in order to do forward assembly.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">forward.ex3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/simPM.html">simPM</a></span>(
  <span class="no">popModel</span>,
  <span class="no">analyzeModel</span>,
  <span class="kw">VarNAMES</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop1"</span>,<span class="st">"SelfPop1"</span>,<span class="st">"Support1"</span>,<span class="st">"PeerPop2"</span>,<span class="st">"SelfPop2"</span>,<span class="st">"Support2"</span>,<span class="st">"PeerPop3"</span>,<span class="st">"SelfPop3"</span>,<span class="st">"Support3"</span>),
  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">n</span><span class="kw">=</span><span class="fl">10</span>,
  <span class="kw">nreps</span><span class="kw">=</span><span class="fl">1000</span>,
  <span class="kw">seed</span><span class="kw">=</span><span class="fl">12345</span>,
  <span class="kw">Time</span><span class="kw">=</span><span class="fl">3</span>,
  <span class="kw">k</span><span class="kw">=</span><span class="fl">3</span>,
  <span class="kw">max.mk</span><span class="kw">=</span><span class="fl">3</span>,
  <span class="kw">Time.complete</span><span class="kw">=</span><span class="fl">1</span>,
  <span class="kw">costmx</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>),
  <span class="kw">pc</span><span class="kw">=</span><span class="fl">0.1</span>,
  <span class="kw">pd</span><span class="kw">=</span><span class="fl">0</span>,
  <span class="kw">focal.param</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PeerPop2~SelfPop1"</span>,<span class="st">"Support2~PeerPop1"</span>,<span class="st">"PeerPop3~SelfPop2"</span>,<span class="st">"Support3~PeerPop2"</span>),
  <span class="kw">eval.budget</span><span class="kw">=</span><span class="no">T</span>,
  <span class="kw">rm.budget</span><span class="kw">=</span><span class="fl">31500L</span>,
  <span class="kw">complete.var</span><span class="kw">=</span><span class="kw">NULL</span>,
  <span class="kw">engine</span><span class="kw">=</span><span class="st">"l"</span>,
  <span class="kw">methods</span><span class="kw">=</span><span class="st">"forward"</span>
)</pre></body></html></div>
<p>While most of the arguments remains the same as in balanced item-level missing designs, here are a few arguments that are different and thus we offer a summary below:</p>
<ul>
<li>
<code>max.mk = 3</code>: In this example, the researcher would want to consider the PM designs with no more than <span style="color:firebrick">3</span> unique missing data patterns.</li>
<li>
<code>methods = "forward"</code>: Search for item-level missing designs via <span style="color:firebrick">forward assembly</span>.</li>
</ul>
</div>
<div id="summarize-the-result-2" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result-2" class="anchor"></a>2. Summarize the Result</h3>
<p>Similarly, to <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">forward.ex3</span>)</pre></body></html></div>
<p>Based on the output, this optimal design costs $30,000, which is below the reduced available budget.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">[1] "=================Optimal design================="
   convergence.rate weakest.param.name weakest.para.power cost.design miss.num miss.var1 miss.var2 miss.var3 sim.seq miss.loc1
16                1  PeerPop2~SelfPop1              0.885       30000        3  SelfPop2  SelfPop3  Support3      16         5
   miss.loc2 miss.loc3
16         8         9</pre></body></html></div>
<p>With this design, 10% of the participants are assigned to provide complete data across all the future waves of data collection. The rest 90% of the participants are randomly assigned to one of the three unique missing data patterns (<span class="math inline">\(n=300\)</span> in each pattern).</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           PeerPop1 SelfPop1 Support1 PeerPop2 SelfPop2 Support2 PeerPop3 SelfPop3 Support3
                  0        0        0        0        1        0        0        1        1
                  0        0        0        0        0        1        0        1        0
                  0        0        0        0        0        0        0        1        0
completers        0        0        0        0        0        0        0        0        0
[1] "=================Optimal probs=================="
[1] 0.3 0.3 0.3 0.1
[1] "=================Optimal ns===================="
[1] 300 300 300 100</pre></body></html></div>
<p>Over 1000 replications, this design yields an empirical power of 0.885 for testing the path coefficient <span class="math inline">\(b_{PS_1}\)</span>, 0.914 for testing the path coefficient <span class="math inline">\(b_{PS_2}\)</span>, 0.906 for testing the path coefficient <span class="math inline">\(b_{TS_1}\)</span>, and 0.937 for testing the path coefficient <span class="math inline">\(b_{TS_2}\)</span>. With this PHPM design, the statistical power is satisfactory for testing each of the focal parameters.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
                  Estimate Average Estimate SD Average SE Power (Not equal 0)    Std Est Std Est SD Std Ave SE Average Param
PeerPop2~SelfPop1        0.0509315  0.01593366 0.01625888               0.885 0.07715693 0.02407530 0.02460888         0.051
Support2~PeerPop1        0.1225502  0.03691843 0.03681819               0.906 0.10899450 0.03257593 0.03257226         0.124
PeerPop3~SelfPop2        0.0568749  0.01686760 0.01728927               0.914 0.08652626 0.02558155 0.02628572         0.056
Support3~PeerPop2        0.1313719  0.03780042 0.03793717               0.937 0.12610467 0.03596546 0.03609359         0.132
                   Average Bias Coverage Average FMI1     SD FMI1
PeerPop2~SelfPop1 -6.849557e-05    0.951  0.004906487 0.002715199
Support2~PeerPop1 -1.449846e-03    0.937  0.275855979 0.020332822
PeerPop3~SelfPop2  8.748955e-04    0.947  0.202017999 0.015647460
Support3~PeerPop2 -6.281368e-04    0.951  0.330559605 0.020608104</pre></body></html></div>
<!--&nbsp;-->
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out the detailed model fitting results over the replications.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">forward.ex3</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design-2" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design-2" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>Similarly, to <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../reference/plotPM.html">plotPM()</a></code> function. As shown in the plot, â€¦</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="../reference/plotPM.html">plotPM</a></span>(<span class="no">forward.ex3</span>, <span class="kw">fontsize_col</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">angle_col</span> <span class="kw">=</span> <span class="fl">90</span>)</pre></body></html></div>
<p><img src="Autoregressive-Cross-Lagged-Model_files/figure-html/unnamed-chunk-15-1.png" width="864"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Package simPMÂ© developed by Yi Feng &amp; Gregory R. Hancock</p>
</div>



<div class="twitter-YF" align="right">
<a href="https://twitter.com/TheYiFeng?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TheYiFeng</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

Â 

<a href="https://twitter.com/GregoryRHancock?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @GregoryRHancock</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

      </footer>
</div>

  


  </body>
</html>
