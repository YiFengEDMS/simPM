<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An example of PHPM with a second-order LGM • simPM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="An example of PHPM with a second-order LGM">
<meta property="og:description" content="simPM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">simPM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../../articles/Autoregressive-Cross-Lagged-Model.html">An Example of PHPM with an Autoregression and Cross-lagged Model</a>
    </li>
    <li>
      <a href="../../articles/Conditional-Linear-Latent-Growth-Model.html">An Example of PHPM with a Conditional Linear Latent Growth Model</a>
    </li>
    <li>
      <a href="../../articles/Wave-Level-PHPM.html">Wave-level PM designs</a>
    </li>
    <li>
      <a href="../../articles/Item-Level-PHPM.html">Item-level PM designs</a>
    </li>
    <li>
      <a href="../../articles/Forward-Assembly-PHPM.html">Forward assembly</a>
    </li>
    <li>
      <a href="../../articles/Summary.html">Summarize the optimal design</a>
    </li>
    <li>
      <a href="../../articles/PlotPM.html">Plot the optimal design</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../manual/simPM_0.0.0.9000.pdf">
    <span class="fa fa-pencil-square-o"></span>
     
    Manual
  </a>
</li>
<li>
  <a href="../../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="../../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    FAQ
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YiFengEDMS/simPM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/TheYiFeng">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An example of PHPM with a second-order LGM</h1>
                        <h4 class="author">Yi Feng &amp; Gregory R. Hancock</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/YiFengEDMS/simPM/blob/master/vignettes/old/Second-Order-Latent-Growth-Model.Rmd"><code>vignettes/old/Second-Order-Latent-Growth-Model.Rmd</code></a></small>
      <div class="hidden name"><code>Second-Order-Latent-Growth-Model.Rmd</code></div>

    </div>

    
    
<!-- -->
<p>In this vignette we supply an example showing how <code>simPM</code> can be used to search for an optimal PHPM design for a longitudinal research study that employs a second-order latent growth model (LGM).</p>
<div id="research-scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#research-scenario" class="anchor"></a><span style="color:seagreen"><strong>Research Scenario</strong></span>
</h2>
<p>In this hypothetical example, a researcher (Mr. Y) is interested in studying the longitudinal trajectories of children’s externalizing behaviors. The researcher proposed to collect reports from the mother, the father, and the teacher about the child’s daily behaviors (from families with hetero-sexual parents). Once the data collection is completed, the researcher intends to model the externalizing behaviors as a latent variable and investigate its change over time.</p>
<p>Suppose the researcher has proposed a complete-case longitudinal study to collect data for 1,135 children across four waves, each collected at grades 1, 3, 4, and 5. The proposed analysis model is shown below, where the three indicators of the latent construct (externalizing behavior) <span class="math inline">\(\eta\)</span> across each of the four waves are the responses from the mother (<em>M1</em>-<em>M4</em>), the father (<em>F1</em>-<em>F4</em>), and the teacher (<em>T1</em>-<em>T4</em>), correspondingly.</p>
<p>Although the researcher has initially obtained an external funding to support his longitudinal study, unfortunately, after the first wave of data collection, the funding agency announces a 30% reduction in the remaining funding. Mr. Y wishes to continue the project but he has to deal with the lowered budget constraint. Of course, Mr. Y also wants to keep the scientific rigor and satisfactory statistical power. He thus chooses to use <code>simPM</code> to find a design that yields sufficient power but costs no more than the reduced budget.</p>
<div class="figure" style="text-align: center">
<img src="images/Second-order-LGM.png" alt="A second-order linear LGM" width="50%"><p class="caption">
A second-order linear LGM
</p>
</div>
</div>
<div id="spcify-the-population-and-analysis-model" class="section level2">
<h2 class="hasAnchor">
<a href="#spcify-the-population-and-analysis-model" class="anchor"></a><span style="color:seagreen"><strong>Spcify the Population and Analysis Model</strong></span>
</h2>
<p><code>simPM</code> searches for an optimal design based on power analysis using Monte Carlo simulations. As such, we need to supply a population model and analysis model. The easiest way to specify the population model and analysis model is to use the <a href="http://lavaan.ugent.be/tutorial/syntax1.html"><code>lavaan</code> model syntax</a>. For this Second-order LGM example, the population model is specified as follows, assuming the researcher has obtained sufficient information from the literature to make an informed decision about the population model and the value of population parameters.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">popModel</span><span class="kw">=</span><span class="st">[1272 chars quoted with ''']</span></pre></body></html></div>
<p>The analysis model is specified as the same second-order LGM but with freely estimated model parameters:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">analyzeModel</span><span class="kw">=</span><span class="st">'

#-----first-order latent factor loadings -----#

EXB1=~NA*F1+a*F1+b*T1+1*M1                   # loadings invariant across time
EXB2=~NA*F2+a*F2+b*T2+1*M2
EXB3=~NA*F3+a*F3+b*T3+1*M3
EXB4=~NA*F4+a*F4+b*T4+1*M4

#-----second-order latent factor loadings -----#

interc=~1*EXB1+1*EXB2+1*EXB3+1*EXB4
slope=~0*EXB1+2*EXB2+3*EXB3+4*EXB4

#---- variance-covariance strucutre of second-order latent variables ----#

interc~~slope
interc~~interc
slope~~slope

#---- mean structure ----#

interc~1
slope~1

F1~c*1            # invariant across time
F2~c*1
F3~c*1
F4~c*1

T1~d*1            # invariant across time
T2~d*1
T3~d*1
T4~d*1

M1~0*1            # fixed to 0
M2~0*1
M3~0*1
M4~0*1


#---- residual variances and covariances ----#

EXB1~~EXB1
EXB2~~EXB2
EXB3~~EXB3
EXB4~~EXB4

F1~~F1
F2~~F2
F3~~F3
F4~~F4

T1~~T1
T2~~T2
T3~~T3
T4~~T4

M1~~M1
M2~~M2
M3~~M3
M4~~M4

F1~~F2+F3+F4
F2~~F3+F4
F3~~F4

T1~~T2+T3+T4
T2~~T3+T4
T3~~T4

M1~~M2+M3+M4
M2~~M3+M4
M3~~M4
'</span></pre></body></html></div>
</div>
<div id="wave-level-phpm-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#wave-level-phpm-designs" class="anchor"></a><span style="color:seagreen"><strong>Wave-level PHPM Designs</strong></span>
</h2>
<div id="search-for-an-optimal-wave-level-design" class="section level3">
<h3 class="hasAnchor">
<a href="#search-for-an-optimal-wave-level-design" class="anchor"></a><a name="wave">1. Search for an Optimal Wave-level Design</a>
</h3>
<p>We can use the main function <code><a href="../../reference/simPM.html">simPM()</a></code> to search for an optimal <a href="Wave-Level-PHPM.html">wave-level missing design</a>. For <code><a href="../../reference/simPM.html">simPM()</a></code> to work properly, we need to supply the relevant information about this longitudinal study. By running the following code, <code>simPM</code> will automatically map out all the possible wave-level PHPM designs, run power analysis for each plausible design, and output the optimal design.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">wave.ex2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/simPM.html">simPM</a></span>(<span class="kw">popModel</span> <span class="kw">=</span> <span class="no">popModel</span>,                           <span class="co">#supply the population model using lavaan syntax</span>
                  <span class="kw">analyzeModel</span> <span class="kw">=</span> <span class="no">analyzeModel</span>,                   <span class="co">#supply the analysis model using lavaan syntax</span>
                  <span class="kw">VarNAMES</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F1"</span>,<span class="st">"T1"</span>,<span class="st">"M1"</span>,<span class="st">"F2"</span>,<span class="st">"T2"</span>,<span class="st">"M2"</span>,
                               <span class="st">"F3"</span>,<span class="st">"T3"</span>,<span class="st">"M3"</span>,<span class="st">"F4"</span>,<span class="st">"T4"</span>,<span class="st">"M4"</span>),   <span class="co">#the observed variable names, grouped in waves, in chronological order</span>
                  <span class="kw">Time</span> <span class="kw">=</span> <span class="fl">4</span>,                                      <span class="co">#total number of waves</span>
                  <span class="kw">Time.complete</span> <span class="kw">=</span> <span class="fl">1</span>,                             <span class="co">#number of waves completed before funding cut occurs</span>
                  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>,                                         <span class="co">#number of observed variables collected at each wave</span>
                  <span class="kw">pc</span> <span class="kw">=</span> <span class="fl">0.1</span>,                                      <span class="co">#percentage of participants to provide complete data after funding cut</span>
                  <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">0</span>,                                        <span class="co">#percentage of participants to provide no data after funding cut</span>
                  <span class="kw">costmx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>,<span class="fl">3</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">10</span>,<span class="fl">3</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">15</span>,<span class="fl">3</span>)),    <span class="co">#unit cost of each data point at the following waves</span>
                  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">1135</span>,                                      <span class="co">#original sample size</span>
                  <span class="kw">nreps</span> <span class="kw">=</span> <span class="fl">1000</span>,                                  <span class="co">#number of replications for Monte Carlo simulation</span>
                  <span class="kw">focal.param</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"interc~1"</span>,
                                  <span class="st">"slope~1"</span>,
                                  <span class="st">"interc~~interc"</span>,
                                  <span class="st">"slope~~slope"</span>),               <span class="co">#specify the focal parameters, using lavaan syntax</span>
                  <span class="kw">complete.wave</span> <span class="kw">=</span> <span class="kw">NULL</span>,                          <span class="co">#specify any future wave that need complete data to be collected</span>
                  <span class="kw">eval.budget</span> <span class="kw">=</span> <span class="no">T</span>,                               <span class="co">#whether or not there is a budget restriction</span>
                  <span class="kw">rm.budget</span> <span class="kw">=</span> <span class="fl">90</span>*<span class="fl">1135</span>*<span class="fl">0.7</span>,                       <span class="co">#the amount of remaining budget</span>
                  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,                             <span class="co">#specify any distal variables that are not subject to PM</span>
                  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">12345</span>,                                  <span class="co">#random seed</span>
                  <span class="kw">engine</span> <span class="kw">=</span> <span class="st">"l"</span>,                                  <span class="co">#use lavaan and simsem to fit the models</span>
                  <span class="kw">methods</span> <span class="kw">=</span> <span class="st">"wave"</span>                               <span class="co">#type of PHPM designs under consideration, "wave" indicates wave-level missing</span>
)</pre></body></html></div>
<p>A more detailed explaination of the arguments is offered below:</p>
<ul>
<li>
<code>VarNAMES = c("F1","T1","M1","F2","T2","M2","F3","T3","M3","F4","T4","M4")</code>: The observed variables collected in this study are named <span style="color:firebrick">F1-F4</span> for fathers’ report, <span style="color:firebrick">T1-T4</span> for teachers’ report, and <span style="color:firebrick">M1-M4</span> for mothers’ report from wave 1 to wave 4.</li>
<li>
<code>Time = 4</code>: The study has <span style="color:firebrick">4</span> waves of data collection in total.</li>
<li>
<code>Time.complete = 1</code>: <span style="color:firebrick">One</span> wave of data collection has been completed before funding cut occurs.</li>
<li>
<code>k = 3</code>: <span style="color:firebrick">Three</span> observed variable are collected at each wave of data collection.</li>
<li>
<code>pc = 0.1</code>: <span style="color:firebrick">Ten percent</span> of the participants are randomly assigned to provide complete data for future waves after funding cut.</li>
<li>
<code>pd = 0</code>: <span style="color:firebrick">Zero percent</span> of the participants are assigned to drop from the study.</li>
<li>
<code>costmx = c(rep(5,3), rep(10,3), rep(15,3))</code>: The unit cost of collecting one report from the father, the mother, or the teacher is <span style="color:firebrick">$5</span> at wave 2, <span style="color:firebrick">$10</span> at wave 3, and <span style="color:firebrick">$15</span> at wave 4.<br>
</li>
<li>
<code>n = 1135</code>: The original sample size that the researcher has had planned was <span style="color:firebrick">1,135</span>.</li>
<li>
<code>nreps = 1000</code>: The program will run <span style="color:firebrick">1000</span> replications for Monte Carlo simulations (to assess the empirical power under each plausible design).</li>
<li>
<code>focal.param = c("interc~1", "slope~1", "interc~~interc", "slope~~slope")</code>: The focal parameters of interest are the mean and variance of the latent intercepts and latent slopes for the latent construct of externalizing behaviors.</li>
<li>
<code>complete.wave = NULL</code>: All of the future waves are subject to planned missingness. No future waves are by design to have complete data colleted from all of the participants.</li>
<li>
<code>eval.budget = T</code>: Yes, there is a budget restriction that needs to be taken into consideration.</li>
<li>
<code>rm.budget = 90*1135*0.7</code>: After the funding cut, the researcher will have <span style="color:firebrick"> <span class="math inline">\(\$71,505\)</span> </span> <span class="math inline">\((=90\times1135\times0.7)\)</span> to support the future waves of data collection.</li>
<li>
<code>distal.var = NULL</code>: There are no time-invarying distal variables in the model that are not subject to repeated measures.</li>
<li>
<code>engine = "l"</code>: Data were simulated using <code>simsem</code> and the models were fitted using <code>lavaan</code>.</li>
<li>
<code>methods = "wave"</code>: Search for wave-level missing designs.</li>
</ul>
</div>
<div id="summarize-the-result" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result" class="anchor"></a>2. Summarize the Result</h3>
<p>To <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function. It prints out the comparison among all the plausible wave-level missing designs (the comparison is made with regard to the focal parameter who has the lowest empirical power). The function will also print the optimal design that was selected, the details about the focal parameters for the selected optimal design, the missing data pattern for the selected optimal PHPM design, and the proportion as well as the number of participants assigned to each unqie missing data pattern.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wave.ex2</span>)</pre></body></html></div>
<p>For this example, there is only one possible wave-level PHPM design given the budget constraints. Therefore, the program has run simulations only for this one possible design. This design costs $40,950, which is below the reduced available budget.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">[1] "=================results summary================"
  convergence.rate weakest.param.name weakest.para.power cost.design miss.waves
1            0.702       slope~~slope              0.421       40950          2
[1] "=================Optimal design================="
  convergence.rate weakest.param.name weakest.para.power cost.design miss.waves
1            0.702       slope~~slope              0.421       40950          2</pre></body></html></div>
<p>With this design, 10% of the participants (<span class="math inline">\(n=115\)</span>) are assigned to provide complete data across all the future waves of data collection. The rest 90% of the participants are randomly assigned to one of the three unique missing data patterns (<span class="math inline">\(n=340\)</span> in each pattern).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           F1 T1 M1 F2 T2 M2 F3 T3 M3 F4 T4 M4
            0  0  0  1  1  1  1  1  1  0  0  0
            0  0  0  1  1  1  0  0  0  1  1  1
            0  0  0  0  0  0  1  1  1  1  1  1
completers  0  0  0  0  0  0  0  0  0  0  0  0
[1] "=================Optimal probs=================="
[1] 0.3 0.3 0.3 0.1
[1] "=================Optimal ns===================="
[1] 340 340 340 115</pre></body></html></div>
<p>Over 1000 replications, this design yields an empirical power of 1 for testing the mean intercept (<span class="math inline">\(\mu_\alpha\)</span>), the mean slope (<span class="math inline">\(\mu_\beta\)</span>), and the intercept variance (<span class="math inline">\(\sigma^2_\alpha\)</span>). The statistical power, however, for testing the slope variance <span class="math inline">\(\sigma^2_\beta\)</span> is only 0.421.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
               Estimate Average Estimate SD Average SE Power (Not equal 0)   Std Est   Std Est SD
interc~1              8.2922999  0.18439790 0.18532638               1.000  1.948990 1.108139e-01
slope~1              -0.4349477  0.03524265 0.03648627               1.000 -1.055051 1.095330e+00
interc~~interc       18.2591912  1.98317441 2.01371609               1.000  1.000000 1.507552e-16
slope~~slope          0.2514950  0.14609108 0.14303930               0.421  1.000000 1.400756e-16
               Std Ave SE Average FMI1    SD FMI1
interc~1        0.1131175   0.05958998 0.01523916
slope~1         7.7855138   0.33198048 0.02445560
interc~~interc  0.0000000   0.40317214 0.03075357
slope~~slope    0.0000000   0.80321992 0.01634524</pre></body></html></div>
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out the detailed model fitting results over the replications.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wave.ex2</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>To <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../../reference/plotPM.html">plotPM()</a></code> function. It will plot the missing data pattern matrix so people can have a more intuitive understanding of the optimal design that was selected. In this plot, each row represents a unique missing data pattern. Each column represents an observed variable. The number of participants assigned to each missing data pattern is also labeled.</p>
<p>In this example, we can see that 115 participants are assigned to provide complete data over the future waves of data collection, while the rest of the participants are assigned to one of the three missing data patterns. For instance, three hundred and fourty participants are randomly picked to NOT provide data in wave 2 and wave 3 (the first row of the plot); Another 340 participants are randomly picked to NOT provide data in wave 2 and wave 4 (the second row of the plot).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../../reference/plotPM.html">plotPM</a></span>(<span class="no">wave.ex2</span>)</pre></body></html></div>
<p><img src="Second-Order-Latent-Growth-Model_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
<div id="balanced-item-level-phpm-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#balanced-item-level-phpm-designs" class="anchor"></a><span style="color:seagreen"><strong>Balanced Item-level PHPM Designs</strong></span>
</h2>
<p>Given that the wave-level missing designs, Mr. Y may want to consider other possible types of designs–e.g., <a href="Item-Level-PHPM.html">item-level PM designs</a>.</p>
<div id="item" class="section level3">
<h3 class="hasAnchor">
<a href="#item" class="anchor"></a>1. Search for an Optimal Item-level Design</h3>
<p>The function <code><a href="../../reference/simPM.html">simPM()</a></code> can also be used to search for an optimal <a href="Item-Level-PHPM.html">item-level missing design</a>. The code to search for optimal item-level PHPM designs is very similar to the code used to search for optimal wave-level PHPM designs. The minor differences in the code are highlighted with comments.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">item.ex2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/simPM.html">simPM</a></span>(
  <span class="no">popModel</span>,
  <span class="no">analyzeModel</span>,
  <span class="kw">VarNAMES</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F1"</span>,<span class="st">"T1"</span>,<span class="st">"M1"</span>,<span class="st">"F2"</span>,<span class="st">"T2"</span>,<span class="st">"M2"</span>,
               <span class="st">"F3"</span>,<span class="st">"T3"</span>,<span class="st">"M3"</span>,<span class="st">"F4"</span>,<span class="st">"T4"</span>,<span class="st">"M4"</span>),
  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">1135</span>,
  <span class="kw">nreps</span> <span class="kw">=</span> <span class="fl">1000</span>,
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">12345</span>,
  <span class="kw">Time</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">Time.complete</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">costmx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">15</span>,<span class="fl">15</span>),
  <span class="kw">pc</span> <span class="kw">=</span> <span class="fl">0.1</span>,
  <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">0</span>,
  <span class="kw">focal.param</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"interc~1"</span>,
                  <span class="st">"slope~1"</span>,
                  <span class="st">"interc~~interc"</span>,
                  <span class="st">"slope~~slope"</span>),
  <span class="kw">eval.budget</span> <span class="kw">=</span> <span class="no">T</span>,
  <span class="kw">rm.budget</span> <span class="kw">=</span> <span class="fl">90</span>*<span class="fl">1135</span>*<span class="fl">0.7</span>,
  <span class="kw">complete.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,            <span class="co"># specify any observed variables (items) that need complete data to be collected in the future waves</span>
  <span class="kw">engine</span> <span class="kw">=</span> <span class="st">"l"</span>,
  <span class="kw">methods</span> <span class="kw">=</span> <span class="st">"item"</span>                <span class="co"># type of PHPM designs under consideration, "item" indicates item-level missing</span>
)</pre></body></html></div>
<p>While most of the arguments remain the same as in the case of <a href="#wave">wave-level missing designs</a>, there are two arguments that are slightly different in the context of item-level missing designs:</p>
<ul>
<li>
<code>complete.var = NULL</code>: No observed variables (items) are by design to have complete data colleted from all participants in the future waves of data collection.</li>
<li>
<code>methods = "item"</code>: Search for <span style="color:firebrick">item-level</span> missing designs.</li>
</ul>
</div>
<div id="summarize-the-result-1" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result-1" class="anchor"></a>2. Summarize the Result</h3>
<p>To <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="../../reference/summary.simpm.html">summary.simpm()</a></code> function.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">item.ex2</span>)</pre></body></html></div>
<p>For this example, given the budget constraints, there are five plausible item-level PHPM designs (with missingness balanced across the patterns). The program thus has run simulations for all the five plausible designs and made comparisons across the designs. The optimal design among the 5 balanced item-level missing designs will cost $61,830, which is below the reduced available budget.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">[1] "=================results summary================"
  convergence.rate weakest.param.name weakest.para.power cost.design miss.point
1            0.891       slope~~slope              0.790       61830          4
2            0.857       slope~~slope              0.668       51750          5
3            0.767       slope~~slope              0.543       41670          6
4            0.702       slope~~slope              0.403       31590          7
5            0.566       slope~~slope              0.306       20790          8
[1] "=================Optimal design================="
  convergence.rate weakest.param.name weakest.para.power cost.design miss.point
1            0.891       slope~~slope               0.79       61830          4</pre></body></html></div>
<p>With this design, 10% of the participants are assigned to provide complete data across all the future waves of data collection. The rest 90% of the participants are randomly assigned to one of the 126 unique missing data patterns (<span class="math inline">\(n=8\)</span> in each pattern). In each pattern, the participants are assigned to miss four observed indicators (items) in the future waves of data collection.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           F1 T1 M1 F2 T2 M2 F3 T3 M3 F4 T4 M4
            0  0  0  1  1  1  1  0  0  0  0  0
            0  0  0  1  1  1  0  1  0  0  0  0
            0  0  0  1  1  1  0  0  1  0  0  0
            0  0  0  1  1  1  0  0  0  1  0  0
            0  0  0  1  1  1  0  0  0  0  1  0
            0  0  0  1  1  1  0  0  0  0  0  1
            0  0  0  1  1  0  1  1  0  0  0  0
            0  0  0  1  1  0  1  0  1  0  0  0
            0  0  0  1  1  0  1  0  0  1  0  0
            0  0  0  1  1  0  1  0  0  0  1  0
            0  0  0  1  1  0  1  0  0  0  0  1
            0  0  0  1  1  0  0  1  1  0  0  0
            0  0  0  1  1  0  0  1  0  1  0  0
            0  0  0  1  1  0  0  1  0  0  1  0
            0  0  0  1  1  0  0  1  0  0  0  1
            0  0  0  1  1  0  0  0  1  1  0  0
            0  0  0  1  1  0  0  0  1  0  1  0
            0  0  0  1  1  0  0  0  1  0  0  1
            0  0  0  1  1  0  0  0  0  1  1  0
            0  0  0  1  1  0  0  0  0  1  0  1
            0  0  0  1  1  0  0  0  0  0  1  1
            0  0  0  1  0  1  1  1  0  0  0  0
            0  0  0  1  0  1  1  0  1  0  0  0
            0  0  0  1  0  1  1  0  0  1  0  0
            0  0  0  1  0  1  1  0  0  0  1  0
            0  0  0  1  0  1  1  0  0  0  0  1
            0  0  0  1  0  1  0  1  1  0  0  0
            0  0  0  1  0  1  0  1  0  1  0  0
            0  0  0  1  0  1  0  1  0  0  1  0
            0  0  0  1  0  1  0  1  0  0  0  1
            0  0  0  1  0  1  0  0  1  1  0  0
            0  0  0  1  0  1  0  0  1  0  1  0
            0  0  0  1  0  1  0  0  1  0  0  1
            0  0  0  1  0  1  0  0  0  1  1  0
            0  0  0  1  0  1  0  0  0  1  0  1
            0  0  0  1  0  1  0  0  0  0  1  1
            0  0  0  1  0  0  1  1  1  0  0  0
            0  0  0  1  0  0  1  1  0  1  0  0
            0  0  0  1  0  0  1  1  0  0  1  0
            0  0  0  1  0  0  1  1  0  0  0  1
            0  0  0  1  0  0  1  0  1  1  0  0
            0  0  0  1  0  0  1  0  1  0  1  0
            0  0  0  1  0  0  1  0  1  0  0  1
            0  0  0  1  0  0  1  0  0  1  1  0
            0  0  0  1  0  0  1  0  0  1  0  1
            0  0  0  1  0  0  1  0  0  0  1  1
            0  0  0  1  0  0  0  1  1  1  0  0
            0  0  0  1  0  0  0  1  1  0  1  0
            0  0  0  1  0  0  0  1  1  0  0  1
            0  0  0  1  0  0  0  1  0  1  1  0
            0  0  0  1  0  0  0  1  0  1  0  1
            0  0  0  1  0  0  0  1  0  0  1  1
            0  0  0  1  0  0  0  0  1  1  1  0
            0  0  0  1  0  0  0  0  1  1  0  1
            0  0  0  1  0  0  0  0  1  0  1  1
            0  0  0  1  0  0  0  0  0  1  1  1
            0  0  0  0  1  1  1  1  0  0  0  0
            0  0  0  0  1  1  1  0  1  0  0  0
            0  0  0  0  1  1  1  0  0  1  0  0
            0  0  0  0  1  1  1  0  0  0  1  0
            0  0  0  0  1  1  1  0  0  0  0  1
            0  0  0  0  1  1  0  1  1  0  0  0
            0  0  0  0  1  1  0  1  0  1  0  0
            0  0  0  0  1  1  0  1  0  0  1  0
            0  0  0  0  1  1  0  1  0  0  0  1
            0  0  0  0  1  1  0  0  1  1  0  0
            0  0  0  0  1  1  0  0  1  0  1  0
            0  0  0  0  1  1  0  0  1  0  0  1
            0  0  0  0  1  1  0  0  0  1  1  0
            0  0  0  0  1  1  0  0  0  1  0  1
            0  0  0  0  1  1  0  0  0  0  1  1
            0  0  0  0  1  0  1  1  1  0  0  0
            0  0  0  0  1  0  1  1  0  1  0  0
            0  0  0  0  1  0  1  1  0  0  1  0
            0  0  0  0  1  0  1  1  0  0  0  1
            0  0  0  0  1  0  1  0  1  1  0  0
            0  0  0  0  1  0  1  0  1  0  1  0
            0  0  0  0  1  0  1  0  1  0  0  1
            0  0  0  0  1  0  1  0  0  1  1  0
            0  0  0  0  1  0  1  0  0  1  0  1
            0  0  0  0  1  0  1  0  0  0  1  1
            0  0  0  0  1  0  0  1  1  1  0  0
            0  0  0  0  1  0  0  1  1  0  1  0
 [ reached getOption("max.print") -- omitted 44 rows ]
[1] "=================Optimal probs=================="
  [1] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [12] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [23] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [34] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [45] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [56] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [67] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [78] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
 [89] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
[100] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
[111] 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143 0.007143
[122] 0.007143 0.007143 0.007143 0.007143 0.007143 0.100000
[1] "=================Optimal ns===================="
  [1]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8
 [26]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8
 [51]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8
 [76]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8
[101]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8
[126]   8 127</pre></body></html></div>
<p>Over 1000 replications, this design yields an empirical power of 1 for testing the mean intercept (<span class="math inline">\(\mu_\alpha\)</span>), the mean slope (<span class="math inline">\(\mu_\beta\)</span>), and the intercept variance (<span class="math inline">\(\sigma^2_\alpha\)</span>). The empirical statistical power for testing the slope variance <span class="math inline">\(\sigma^2_\beta\)</span> is 0.79.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
               Estimate Average Estimate SD Average SE Power (Not equal 0)    Std Est   Std Est SD
interc~1              8.2953189  0.18356640 0.18382632                1.00  1.9474106 9.968931e-02
slope~1              -0.4340963  0.03309627 0.03297006                1.00 -0.9299426 2.574645e-01
interc~~interc       18.2697160  1.77895530 1.75026092                1.00  1.0000000 1.529087e-16
slope~~slope          0.2495351  0.09254388 0.09116761                0.79  1.0000000 1.408373e-16
               Std Ave SE Average FMI1     SD FMI1
interc~1       0.09904717   0.03719561 0.005633355
slope~1        0.25572528   0.17422814 0.021089960
interc~~interc 0.00000000   0.20426534 0.022736031
slope~~slope   0.00000000   0.51588859 0.019591327</pre></body></html></div>
<!--&nbsp;-->
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out more detailed information of the simulation results for the optimal PHPM design.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">item.ex2</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design-1" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design-1" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>Similarly, to <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../../reference/plotPM.html">plotPM()</a></code> function. As shown in the plot, 90% of the participants are randomly assigned to one of the 126 unique missing data patterns. For each missing data pattern, the participants will have missing data by design on four of the observed variables (indicators/items). For example, if a participant is assigned to the first missing data pattern (first row), the researcher will not collect data from the father, mother, nor the teacher at wave 2; at wave 3, the researcher will only collect data from the mother and the teacher, but not the father.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../../reference/plotPM.html">plotPM</a></span>(<span class="no">item.ex2</span>, <span class="kw">row.names</span><span class="kw">=</span><span class="no">F</span>)</pre></body></html></div>
<p><img src="Second-Order-Latent-Growth-Model_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
</div>
<div id="item-level-phpm-designs-via-forward-assembly" class="section level2">
<h2 class="hasAnchor">
<a href="#item-level-phpm-designs-via-forward-assembly" class="anchor"></a><span style="color:seagreen"><strong>Item-level PHPM Designs via Forward Assembly</strong></span>
</h2>
<p>The optimal balanced item-level PHPM designs yields satisfactory power for testing the focal parameters. But with an excessive number of missing data patterns, it is hard to implement such a design in practice. Therefore, we could consider another searching strategy for item-level PHPM designs–the <a href="Forward-Assembly-PHPM.html">forward assembly</a>.</p>
<div id="search-for-an-optimal-item-level-design-via-forward-assembly" class="section level3">
<h3 class="hasAnchor">
<a href="#search-for-an-optimal-item-level-design-via-forward-assembly" class="anchor"></a>1. Search for an Optimal Item-level Design via Forward Assembly</h3>
<p>We can also use the function <code><a href="../../reference/simPM.html">simPM()</a></code> to search for an optimal <a href="Forward-Assembly-PHPM.html">item-level missing design via forward assembly</a>. We only need to change a few arguments within the <code><a href="../../reference/simPM.html">simPM()</a></code> function in order to implement forward assembly.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">forward.ex2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/simPM.html">simPM</a></span>(
  <span class="kw">analyzeModel</span> <span class="kw">=</span> <span class="no">analyzeModel</span>,
  <span class="kw">popModel</span> <span class="kw">=</span> <span class="no">popModel</span>,
  <span class="kw">VarNAMES</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F1"</span>,<span class="st">"T1"</span>,<span class="st">"M1"</span>,<span class="st">"F2"</span>,<span class="st">"T2"</span>,<span class="st">"M2"</span>,
               <span class="st">"F3"</span>,<span class="st">"T3"</span>,<span class="st">"M3"</span>,<span class="st">"F4"</span>,<span class="st">"T4"</span>,<span class="st">"M4"</span>),
  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">1135</span>,
  <span class="kw">nreps</span> <span class="kw">=</span> <span class="fl">1000</span>,
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123321</span>,
  <span class="kw">Time</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">Time.complete</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">costmx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">10</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">15</span>,<span class="fl">3</span>)),
  <span class="kw">pc</span> <span class="kw">=</span> <span class="fl">0.05</span>,
  <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">0</span>,
  <span class="kw">focal.param</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"interc~1"</span>,
                  <span class="st">"slope~1"</span>,
                  <span class="st">"interc~~interc"</span>,
                  <span class="st">"slope~~slope"</span>),
  <span class="kw">max.mk</span> <span class="kw">=</span> <span class="fl">5</span>,                                      <span class="co">#maximum number of unique missing data patterns allowed in the design</span>
  <span class="kw">eval.budget</span> <span class="kw">=</span> <span class="no">T</span>,
  <span class="kw">rm.budget</span> <span class="kw">=</span> <span class="fl">1135</span>*(<span class="fl">15</span>+<span class="fl">30</span>+<span class="fl">45</span>)*<span class="fl">0.7</span>,
  <span class="kw">complete.var</span> <span class="kw">=</span> <span class="st">"M3"</span>,                             <span class="co">#assume the researcher wants to collect complete data from the mothers at wave 3</span>
  <span class="kw">engine</span> <span class="kw">=</span> <span class="st">"l"</span>,
  <span class="kw">methods</span> <span class="kw">=</span> <span class="st">"forward"</span>                              <span class="co">#type of PHPM designs under consideration, "forward" indicates imbalanced item-level PM designs searched via forward assembly.</span>
)</pre></body></html></div>
<p>While most of the arguments remains the same as in balanced item-level PHPM designs, here are a few arguments that are different and thus we offer a brief summary below:</p>
<ul>
<li>
<code>max.mk = 5</code>: In this example, the researcher would want to consider the PM designs with no more than <span style="color:firebrick">5</span> unique missing data patterns.</li>
<li>
<code>methods = "forward"</code>: Search for item-level missing designs via <span style="color:firebrick">forward assembly</span>.</li>
</ul>
</div>
<div id="summarize-the-result-2" class="section level3">
<h3 class="hasAnchor">
<a href="#summarize-the-result-2" class="anchor"></a>2. Summarize the Result</h3>
<p>Similarly, to <a href="Summary.html">view a summary of the results</a>, we can use the <code><a href="../../reference/summary.simpm.html">summary.simpm()</a></code> function.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">forward.ex2</span>)</pre></body></html></div>
<p>According to the output, the optimal design costs $69,802.5, which is below the reduced available budget.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">[1] "=================Optimal design================="
   convergence.rate weakest.param.name weakest.para.power cost.design miss.num miss.var1 miss.var2
48             0.93       slope~~slope               0.94     69802.5        5        T2        F3
   miss.var3 miss.var4 miss.var5 sim.seq miss.loc1 miss.loc2 miss.loc3 miss.loc4 miss.loc5
48        T3        T4        M4      48         5         7         8        11        12</pre></body></html></div>
<p>With this design, 5% of the participants are assigned to provide complete data across all the future waves of data collection. The rest 95% of the participants are randomly assigned to one of the five unique missing data patterns (<span class="math inline">\(n=215\)</span> in each pattern).</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">[1] "=================Optimal patterns==============="
           F1 T1 M1 F2 T2 M2 F3 T3 M3 F4 T4 M4
            0  0  0  0  1  0  1  1  0  0  1  1
            0  0  0  0  1  1  1  0  0  0  1  0
            0  0  0  0  0  1  1  0  0  0  0  1
            0  0  0  0  0  1  0  0  0  0  1  0
            0  0  0  0  0  0  0  1  0  0  0  0
completers  0  0  0  0  0  0  0  0  0  0  0  0
[1] "=================Optimal probs=================="
[1] 0.19 0.19 0.19 0.19 0.19 0.05
[1] "=================Optimal ns===================="
[1] 215 215 215 215 215  60</pre></body></html></div>
<p>Over 1000 replications, this design yields an empirical power of 0.94 for testing the slope variance <span class="math inline">\(\sigma^2_\beta\)</span>, and 1 for testing the mean intercept (<span class="math inline">\(\mu_\alpha\)</span>), the mean slope (<span class="math inline">\(\mu_\beta\)</span>), and the intercept variance (<span class="math inline">\(\sigma^2_\alpha\)</span>).</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">
[1] "=================Optimal design for focal parameters================="
               Estimate Average Estimate SD Average SE Power (Not equal 0)    Std Est   Std Est SD Std Ave SE Average FMI1     SD FMI1
interc~1              8.2865724  0.18423599 0.18257516                1.00  1.9443858 9.325732e-02 0.09379636   0.02365522 0.006379778
slope~1              -0.4329607  0.03256262 0.03172940                1.00 -0.9003786 2.070116e-01 0.18404313   0.10842323 0.019047938
interc~~interc       18.2731813  1.68107536 1.66210528                1.00  1.0000000 1.554693e-16 0.00000000   0.11784586 0.021024875
slope~~slope          0.2502644  0.07226992 0.07443478                0.94  1.0000000 1.438019e-16 0.00000000   0.27518386 0.024379875</pre></body></html></div>
<!--&nbsp;-->
<p>To view more details of the optimal PHPM design, we can use the following code, which will print out the detailed model fitting results over the replications.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">forward.ex2</span>$<span class="no">opt.output</span>)</pre></body></html></div>
</div>
<div id="visualize-the-optimal-design-2" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-optimal-design-2" class="anchor"></a>3. Visualize the Optimal Design</h3>
<p>Similarly, to <a href="PlotPM.html">visualize the missing data patterns of the optimal PHPM design</a>, we can use the <code><a href="../../reference/plotPM.html">plotPM()</a></code> function. As shown in the plot, …</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="../../reference/plotPM.html">plotPM</a></span>(<span class="no">forward.ex2</span>)</pre></body></html></div>
<p><img src="Second-Order-Latent-Growth-Model_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Package simPM© developed by Yi Feng &amp; Gregory R. Hancock</p>
</div>



<div class="twitter-YF" align="right">
<a href="https://twitter.com/TheYiFeng?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TheYiFeng</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

 

<a href="https://twitter.com/GregoryRHancock?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @GregoryRHancock</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

      </footer>
</div>

  


  </body>
</html>
