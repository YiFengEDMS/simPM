<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wave-level PHPM designs • simPM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Wave-level PHPM designs">
<meta property="og:description" content="simPM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">simPM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../../articles/Autoregressive-Cross-Lagged-Model.html">An Example of PHPM with an Autoregression and Cross-lagged Model</a>
    </li>
    <li>
      <a href="../../articles/Conditional-Linear-Latent-Growth-Model.html">An Example of PHPM with a Conditional Linear Latent Growth Model</a>
    </li>
    <li>
      <a href="../../articles/Wave-Level-PHPM.html">Wave-level PM designs</a>
    </li>
    <li>
      <a href="../../articles/Item-Level-PHPM.html">Item-level PM designs</a>
    </li>
    <li>
      <a href="../../articles/Forward-Assembly-PHPM.html">Forward assembly</a>
    </li>
    <li>
      <a href="../../articles/Summary.html">Summarize the optimal design</a>
    </li>
    <li>
      <a href="../../articles/PlotPM.html">Plot the optimal design</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../manual/simPM_0.0.0.9000.pdf">
    <span class="fa fa-pencil-square-o"></span>
     
    Manual
  </a>
</li>
<li>
  <a href="../../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="../../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    FAQ
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YiFengEDMS/simPM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/TheYiFeng">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Wave-level PHPM designs</h1>
                        <h4 class="author">Yi Feng &amp; Gregory R. Hancock</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/YiFengEDMS/simPM/blob/master/vignettes/old/Wave-Level-PHPM.Rmd"><code>vignettes/old/Wave-Level-PHPM.Rmd</code></a></small>
      <div class="hidden name"><code>Wave-Level-PHPM.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a><span style="color:seagreen"><strong>Introduction</strong></span>
</h2>
<p>In this vignette we will introduce the wave-level PHPM designs. As the name suggests, in wave-level PHPM designs, the missingness is imposed at the wave level. In those designs, participants are assigned to miss one or more waves of future data collection. If a participant is assigned to miss a specific wave of data collection, the researcher will not collect any data from this participant in that wave.</p>
<p>Wave-level PHPM designs are relatively easy to implement. But there is usually a very limited number of plausible wave-level missing designs, and thus sometimes the search among wave-level PHPM designs may not yield a satisfactory result in terms of statistical power.</p>
</div>
<div id="search-for-wave-level-phpm-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#search-for-wave-level-phpm-designs" class="anchor"></a><span style="color:seagreen"><strong>Search for wave-level PHPM designs</strong></span>
</h2>
<p>To search for wave-level PHPM designs using <code>simPM</code>, we only need to specify the <code>methods = "wave"</code> argument when using the <code><a href="../../reference/simPM.html">simPM()</a></code> function.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a><span style="color:seagreen"><strong>Example</strong></span>
</h2>
<p>In this <a href="Second-Order-Latent-Growth-Model.html">hypothetical example</a>, a researcher (Mr. Y) is interested in studying the longitudinal trajectories of children’s externalizing behaviors. The researcher proposed to collect reports from the mother, the father, and the teacher about the child’s daily behaviors (from families with hetero-sexual parents). Once the data collection is completed, the researcher intends to model the externalizing behaviors as a latent variable and investigate its change over time.</p>
<p>Suppose the researcher has proposed a complete-case longitudinal study to collect data for 1,135 children across four waves, each collected at grades 1, 3, 4, and 5. The proposed analysis model is shown below, where the three indicators of the latent construct (externalizing behavior) <span class="math inline">\(\eta\)</span> across each of the four waves are the responses from the mother (<em>M1</em>-<em>M4</em>), the father (<em>F1</em>-<em>F4</em>), and the teacher (<em>T1</em>-<em>T4</em>), correspondingly.</p>
<p>Although the researcher has initially obtained an external funding to support his longitudinal study, unfortunately, after the first wave of data collection, the funding agency announces a 30% reduction in the remaining funding. Mr. Y wishes to continue the project but he has to deal with the lowered budget constraint. Of course, Mr. Y also wants to keep the scientific rigor and satisfactory statistical power. He thus chooses to use <code>simPM</code> to find a design that yields sufficient power but costs no more than the reduced budget.</p>
<div class="figure" style="text-align: center">
<img src="images/Second-order-LGM.png" alt="A second-order linear LGM" width="50%"><p class="caption">
A second-order linear LGM
</p>
</div>
<p>After supplying the population model and the analysis model, we can use the function <code><a href="../../reference/simPM.html">simPM()</a></code> to search for an optimal wave-level missing design with the <code>methods = "wave"</code> argument. For more details about the specification of other arguments, please refer to <a href="Second-Order-Latent-Growth-Model.html">this vignette</a>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">popModel</span><span class="kw">=</span><span class="st">'
EXB1=~1.150*F1+0.836*T1+1*M1
EXB2=~1.150*F2+0.836*T2+1*M2
EXB3=~1.150*F3+0.836*T3+1*M3
EXB4=~1.150*F4+0.836*T4+1*M4


interc=~1*EXB1+1*EXB2+1*EXB3+1*EXB4
slope=~0*EXB1+2*EXB2+3*EXB3+4*EXB4

interc~~-0.244*slope

interc~8.289*1
slope~-0.433*1

interc~~18.184*interc
slope~~0.249*slope

EXB1~~1.084*EXB1
EXB2~~1.777*EXB2
EXB3~~1.457*EXB3
EXB4~~1.700*EXB4

T1~-0.214*1
T2~-0.214*1
T3~-0.214*1
T4~-0.214*1

M1~0*1
M2~0*1
M3~0*1
M4~0*1

F1~-1.136*1
F2~-1.136*1
F3~-1.136*1
F4~-1.136*1


M1~~23.886*M1
F1~~17.737*F1
T1~~55.074*T1 
M2~~20.223*M2      
F2~~8.941*F2      
T2~~66.698*T2      
M3~~16.905*M3      
F3~~13.922*F3      
T3~~61.995*T3 
M4~~19.324*M4 
F4~~13.410*F4      
T4~~71.127*T4

F1~~4.256*F2+7.040*F3+5.737*F4
F2~~5.440*F3+3.590*F4
F3~~6.165*F4

T1~~23.603*T2+24.666*T3+23.168*T4
T2~~35.213*T3+29.648*T4
T3~~33.815*T4

M1~~12.975*M2+11.153*M3+11.683*M4
M2~~12.219*M3+11.332*M4
M3~~11.807*M4

'</span></pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">analyzeModel</span><span class="kw">=</span><span class="st">'

EXB1=~NA*F1+a*F1+b*T1+1*M1
EXB2=~NA*F2+a*F2+b*T2+1*M2
EXB3=~NA*F3+a*F3+b*T3+1*M3
EXB4=~NA*F4+a*F4+b*T4+1*M4

interc=~1*EXB1+1*EXB2+1*EXB3+1*EXB4
slope=~0*EXB1+2*EXB2+3*EXB3+4*EXB4

interc~~slope

interc~1
slope~1
interc~~interc
slope~~slope

EXB1~~EXB1
EXB2~~EXB2
EXB3~~EXB3
EXB4~~EXB4

F1~c*1
F2~c*1
F3~c*1
F4~c*1

T1~d*1
T2~d*1
T3~d*1
T4~d*1

M1~0*1
M2~0*1
M3~0*1
M4~0*1

F1~~F1
F2~~F2
F3~~F3
F4~~F4

T1~~T1
T2~~T2
T3~~T3
T4~~T4

M1~~M1
M2~~M2
M3~~M3
M4~~M4

F1~~F2+F3+F4
F2~~F3+F4
F3~~F4

T1~~T2+T3+T4
T2~~T3+T4
T3~~T4

M1~~M2+M3+M4
M2~~M3+M4
M3~~M4
'</span></pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">wave.ex2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/simPM.html">simPM</a></span>(<span class="kw">popModel</span> <span class="kw">=</span> <span class="no">popModel</span>,
                  <span class="kw">analyzeModel</span> <span class="kw">=</span> <span class="no">analyzeModel</span>,
                  <span class="kw">VarNAMES</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F1"</span>,<span class="st">"T1"</span>,<span class="st">"M1"</span>,<span class="st">"F2"</span>,<span class="st">"T2"</span>,<span class="st">"M2"</span>,
                               <span class="st">"F3"</span>,<span class="st">"T3"</span>,<span class="st">"M3"</span>,<span class="st">"F4"</span>,<span class="st">"T4"</span>,<span class="st">"M4"</span>),
                  <span class="kw">Time</span> <span class="kw">=</span> <span class="fl">4</span>,
                  <span class="kw">Time.complete</span> <span class="kw">=</span> <span class="fl">1</span>,
                  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>,
                  <span class="kw">pc</span> <span class="kw">=</span> <span class="fl">0.1</span>,
                  <span class="kw">pd</span> <span class="kw">=</span> <span class="fl">0</span>,
                  <span class="kw">costmx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>,<span class="fl">3</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">10</span>,<span class="fl">3</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">15</span>,<span class="fl">3</span>)),
                  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">1135</span>,
                  <span class="kw">nreps</span> <span class="kw">=</span> <span class="fl">1000</span>,
                  <span class="kw">focal.param</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"interc~1"</span>,
                                  <span class="st">"slope~1"</span>,
                                  <span class="st">"interc~~interc"</span>,
                                  <span class="st">"slope~~slope"</span>),
                  <span class="kw">complete.wave</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                  <span class="kw">eval.budget</span> <span class="kw">=</span> <span class="no">T</span>,
                  <span class="kw">rm.budget</span> <span class="kw">=</span> <span class="fl">90</span>*<span class="fl">1135</span>*<span class="fl">0.7</span>,
                  <span class="kw">distal.var</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">12345</span>,
                  <span class="kw">engine</span> <span class="kw">=</span> <span class="st">"l"</span>,
                  <span class="kw">methods</span> <span class="kw">=</span> <span class="st">"wave"</span>                               <span class="co">#type of PHPM designs under consideration, "wave" indicates wave-level missing</span>
)</pre></body></html></div>
<p>By running the code above, <code>simPM</code> will map out the possible wave-level PHPM designs and determine whether the cost of each design is within the remaining budget limit. It will run Monte Carlo simulations for the plausible designs that cost less than the remaining amount of funding. Comparisons are made among the plausible designs. The design that yields higher empirical statistical power with regard to the focal parameters will be selected as the optimal wave-level PHPM design.</p>
<p>In this example, there is only one plausible wave-level PHPM design, given we have specified that 10% of the participants will provide complete data over the following waves of data collection.</p>
<p>From the output, we can see that 115 participants are assigned to provide complete data over the future waves of data collection, while the rest of the participants are assigned to one of the three missing data patterns. More specifically, three hundred and fourty participants are randomly picked to NOT provide data in wave 2 and wave 3 (the first row of the plot); another 340 participants are randomly picked to NOT provide data in wave 2 and wave 4 (the second row of the plot); the rest 340 participants are by design to not provide data in wave 3 and wave 4.</p>
<p>This design yields satisfactory statistical power for testing three of the four focal parameters (<code>interc~1</code>, <code>slope~1</code>, and <code>interc~~interc</code>). But the statistical power for testing the focal parameter <code>slope~~slope</code> is only 0.421.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wave.ex2</span>)
<span class="co">#&gt; [1] "=================results summary================"</span>
<span class="co">#&gt;   convergence.rate weakest.param.name weakest.para.power cost.design</span>
<span class="co">#&gt; 1            0.702       slope~~slope              0.421       40950</span>
<span class="co">#&gt;   miss.waves</span>
<span class="co">#&gt; 1          2</span>
<span class="co">#&gt; [1] "=================Optimal design================="</span>
<span class="co">#&gt;   convergence.rate weakest.param.name weakest.para.power cost.design</span>
<span class="co">#&gt; 1            0.702       slope~~slope              0.421       40950</span>
<span class="co">#&gt;   miss.waves</span>
<span class="co">#&gt; 1          2</span>
<span class="co">#&gt; [1] "=================Optimal design for focal parameters================="</span>
<span class="co">#&gt;                Estimate Average Estimate SD Average SE Power (Not equal 0)</span>
<span class="co">#&gt; interc~1              8.2922999  0.18439790 0.18532638               1.000</span>
<span class="co">#&gt; slope~1              -0.4349477  0.03524265 0.03648627               1.000</span>
<span class="co">#&gt; interc~~interc       18.2591912  1.98317441 2.01371609               1.000</span>
<span class="co">#&gt; slope~~slope          0.2514950  0.14609108 0.14303930               0.421</span>
<span class="co">#&gt;                  Std Est   Std Est SD Std Ave SE Average FMI1    SD FMI1</span>
<span class="co">#&gt; interc~1        1.948990 1.108139e-01  0.1131175   0.05958998 0.01523916</span>
<span class="co">#&gt; slope~1        -1.055051 1.095330e+00  7.7855138   0.33198048 0.02445560</span>
<span class="co">#&gt; interc~~interc  1.000000 1.507552e-16  0.0000000   0.40317214 0.03075357</span>
<span class="co">#&gt; slope~~slope    1.000000 1.400756e-16  0.0000000   0.80321992 0.01634524</span>
<span class="co">#&gt; [1] "=================Optimal patterns==============="</span>
<span class="co">#&gt;            F1 T1 M1 F2 T2 M2 F3 T3 M3 F4 T4 M4</span>
<span class="co">#&gt;             0  0  0  1  1  1  1  1  1  0  0  0</span>
<span class="co">#&gt;             0  0  0  1  1  1  0  0  0  1  1  1</span>
<span class="co">#&gt;             0  0  0  0  0  0  1  1  1  1  1  1</span>
<span class="co">#&gt; completers  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [1] "=================Optimal probs=================="</span>
<span class="co">#&gt; [1] 0.3 0.3 0.3 0.1</span>
<span class="co">#&gt; [1] "=================Optimal ns===================="</span>
<span class="co">#&gt; [1] 340 340 340 115</span></pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../../reference/plotPM.html">plotPM</a></span>(<span class="no">wave.ex2</span>)</pre></body></html></div>
<p><img src="Wave-Level-PHPM_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Package simPM© developed by Yi Feng &amp; Gregory R. Hancock</p>
</div>



<div class="twitter-YF" align="right">
<a href="https://twitter.com/TheYiFeng?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TheYiFeng</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

 

<a href="https://twitter.com/GregoryRHancock?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @GregoryRHancock</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

      </footer>
</div>

  


  </body>
</html>
